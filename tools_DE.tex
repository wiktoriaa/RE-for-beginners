\chapter{Tools}

\epigraph{Now that Dennis Yurichev has made this book free (libre), it is a
contribution to the world of free knowledge and free education.
However, for our freedom's sake, we need free (libre) reverse
engineering tools to replace the proprietary tools described in this book.}{Richard M. Stallman}

\section{Binäre Analyse}

Tools die genutzt werden können, wenn kein Prozess gestartet wurde.

\myindex{Hiew}
\myindex{GHex}
\myindex{UNIX!strings}
\myindex{UNIX!xxd}
\myindex{UNIX!od}

\begin{itemize}
\item
(kostenlos, Open Source) \IT{ent}\footnote{\url{http://www.fourmilab.ch/random/}}: Entropie-Analyse-Tool.
Mehr über Entropie: \myref{entropy}.

\item
\label{Hiew}
\IT{Hiew}\footnote{\href{http://go.yurichev.com/17035}{hiew.ru}}:
für kleinere Modifikationen von Code in Binärdateien.
Beinhaltet einen Assembler / Dissassembler.

\item (kostenlos, Open Source) \IT{GHex}\footnote{\url{https://wiki.gnome.org/Apps/Ghex}}: Einfacher Hex-Editor für Linux.

\item (kostenlos, Open Source) \IT{xxd} und \IT{od}: Standard UNIX-Tools für Dumping.

\item (kostenlos, Open Source) \IT{strings}: *NIX-Tool für das Suchen von ASCII-Zeichenketten in Binärdateien,
inklusive ausführbaren Dateien.
Sysinternals hat eine Alternative\footnote{\url{https://technet.microsoft.com/en-us/sysinternals/strings}}
die Wide-Charakter-Zeichenketten unterstützt (UTF-16, unter Windows weit verbreitet).

\item (kostenlos, Open Source) \IT{Binwalk}\footnote{\url{http://binwalk.org/}}: Analyse von Firmware-Images.

\item
\myindex{binary grep}
(kostenlos, Open Source) \IT{binary grep}:
ein kleines Tool um jede Byte-Sequenz in einer großen Anzahl von Dateien zu suchen,
inklusive nicht-ausführbaren Dateien: \BGREPURL.
\myindex{rafind2}
Es gibt auch rafind2 in rada.re mit dem gleichen Verwendungszweck.
\end{itemize}

\subsection{Disassembler}

\myindex{IDA}
\myindex{Binary Ninja}
\myindex{BinNavi}
\myindex{objdump}

\begin{itemize}
\item \IT{IDA}. Eine ältere Freeware-Version ist online erhältlich
\footnote{\href{http://go.yurichev.com/17031}{hex-rays.com/products/ida/support/download\_freeware.shtml}}.
\ShortHotKeyCheatsheet: \myref{sec:IDA_cheatsheet}

\item \IT{Binary Ninja}\footnote{\url{http://binary.ninja/}}

\item (kostenlos, Open Source) \IT{zynamics BinNavi}\footnote{\url{https://www.zynamics.com/binnavi.html}}

\item (kostenlos, Open Source) \IT{objdump}: Einfaches Kommandozeilen-Tool für Dumping und zum disassemblieren.

\item (kostenlos, Open Source) \IT{readelf}\footnote{\url{https://sourceware.org/binutils/docs/binutils/readelf.html}}:
Gibt Informationen über ELF-Dateien aus.
\end{itemize}

\subsection{Decompiler}

Es gibt lediglich einen bekannten, öffentlich verfügbaren Decompiler für C-Code in
hoher Qualität: \IT{Hex-Rays}:\\
\href{http://go.yurichev.com/17033}{hex-rays.com/products/decompiler/}

Mehr darüber: \myref{hex_rays}.

\subsection{Vergleichen von Patches}

Diese Tools können genutzt werden wenn die Original-Version einer ausführbaren Datei
mit einer veränderten Version verglichen werden soll, oder um herauszufinden was
verändert wurde und warum.

\begin{itemize}
\item (kostenlos) \IT{zynamics BinDiff}\footnote{\url{https://www.zynamics.com/software.html}}

\item (kostenlos, Open Source) \IT{Diaphora}\footnote{\url{https://github.com/joxeankoret/diaphora}}
\end{itemize}

\section{Live-Analyse}

Tools die im Live-System oder auf laufende Prozesse angewandt werden können.

\subsection{Debugger}

\myindex{\olly}
\myindex{Radare}
\myindex{GDB}
\myindex{tracer}
\myindex{LLDB}
\myindex{WinDbg}
\myindex{IDA}

\begin{itemize}
\item (kostenlos) \IT{OllyDbg}.
Sehr populärer user-mode Debugger für die Win32-Architektur\footnote{\href{http://go.yurichev.com/17032}{ollydbg.de}}.
\ShortHotKeyCheatsheet: \myref{sec:Olly_cheatsheet}

\item (kostenlos, Open Source) \IT{GDB}.
Nicht sehr populärer Debugger unter Reverse Engineers, da eher für Programmierer gemacht.
Einige Kommandos: \myref{sec:GDB_cheatsheet}.
Es gibt eine grafische Oberfläche für GDB, ``GDB dashboard''\footnote{\url{https://github.com/cyrus-and/gdb-dashboard}}.

\item (kostenlos, Open Source) \IT{LLDB}\footnote{\url{http://lldb.llvm.org/}}.

\item \IT{WinDbg}\footnote{\url{https://developer.microsoft.com/en-us/windows/hardware/windows-driver-kit}}:
Kernel-Debugger für Windows.

\item \IT{IDA} hat einen internen Debugger.

\item (kostenlos, Open Source) \IT{Radare} \ac{AKA} rada.re \ac{AKA} r2\footnote{\url{http://rada.re/r/}}.
Es existiert auch eine GUI: \IT{ragui}\footnote{\url{http://radare.org/ragui/}}.

\item (kostenlos, Open Source) \IT{tracer}.
\label{tracer}
Der Auto benutzt oft \IT{tracer}
\footnote{\href{http://go.yurichev.com/17338}{yurichev.com}}
anstatt Debugger.

Der Autor dieses Buchs hat irgendwann aufgehört Debugger zu nutzen, da alles was er von diesen
brauchte die Funktionsargumente während der Ausführung oder die Zustände der Register an einem
bestimmten Punkt anzuzeigen.
Jedes Mal den Debugger zu starten ist zu aufwändig, deswegen entstand das kleine Tool \IT{tracer}.
Es funktioniert in der Kommandozeile und erlaubt es Funktionsauführungen abzufangen,
Breakpoints an beliebigen Stellen zu setzen und Register-Zustände zu lesen und ändern.

\IT{tracer} wird nicht weiterentwickelt, weil es als Demonstrationstool für dieses Buch entstand
und nicht als Tool für den Alltag.
\end{itemize}

\subsection{Tracen von Bibliotheksaufrufen}

\IT{ltrace}\footnote{\url{http://www.ltrace.org/}}.

\subsection{Tracen von Systemaufrufe}

\label{strace}
\myindex{strace}
\myindex{dtruss}
\subsubsection{strace / dtruss}

\myindex{syscall}
Dies zeigt welche Systemaufrufe (syscalls(\myref{syscalls})) vom aktuellen Prozess aufgerufen werden.

Zum Beispiel:

\begin{lstlisting}
# strace df -h

...

access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/i386-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\220\232\1\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1770984, ...}) = 0
mmap2(NULL, 1780508, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xb75b3000
\end{lstlisting}

\myindex{\MacOSX}
\MacOSX hat dtruss für den Selben Verwendungszweck.

\myindex{Cygwin}
Cygwin beinhaltet ebenso strace, funktioniert aber soweit bekannt nur mit .exe-Dateien
die für die Cygwin-Umgebung kompiliert wurden.

\subsection{Netzwerk-Analyse (Sniffing)}

\IT{Sniffing} ist das Abfangen einiger Informationen die interessant sein könnten.

(kostenlos, Open Source) \IT{Wireshark}\footnote{\url{https://www.wireshark.org/}} für Netzwerk-Analyse.
Stellt ebenfalls die Möglichkeit USB-Schnittstellen zu analysieren\footnote{\url{https://wiki.wireshark.org/CaptureSetup/USB}}.

Wireshark hat einen jüngeren (or älteren) Bruder \IT{tcpdump}\footnote{\url{http://www.tcpdump.org/}},
bei dem es sich um ein simples Kommandozeilen-Tool handelt.

\subsection{Sysinternals}

\myindex{Sysinternals}
(kostenlos) Sysinternals (entwickelt von Mark Russinovich)
\footnote{\url{https://technet.microsoft.com/en-us/sysinternals/bb842062}}.
Zumindest die folgenden Tools sind wichtig und wert sich damit zu beschäftigen:
Process Explorer, Handle, VMMap, TCPView, Process Monitor.

\subsection{Valgrind}

(kostenlos, Open Source) ein mächtiges Tool um Speicherlecks zu finden: \url{http://valgrind.org/}.
Wegen des ausgeklügelten \ac{JIT}-Mechanismus wird Valgrind oft als Framework für andere Tools genutzt.

% TODO network fuzzing

\subsection{Emulatoren}

\begin{itemize}
\item (kostenlos, Open Source) \IT{QEMU}\footnote{\url{http://qemu.org}}: Emulator für verschiedene CPUs und Architekturen.

\item (kostenlos, Open Source) \IT{DosBox}\footnote{\url{https://www.dosbox.com/}}: MS-DOS-Emulator, meist genutzt für Retro-Gaming.

\item (kostenlos, Open Source) \IT{SimH}\footnote{\url{http://simh.trailing-edge.com/}}: Emulator für ältere Computer, Mainframes, etc.
\end{itemize}

\section{Andere Tools}

\IT{Microsoft Visual Studio Express}
\footnote{\href{http://go.yurichev.com/17034}{visualstudio.com/en-US/products/visual-studio-express-vs}}:
Abgespeckte, freie Variante von Visual Studio, praktisch für einfache Experimente.

Einige nützliche Optionen: \myref{sec:MSVC_options}.

Es gibt eine Website die ``Compiler Explorer'' heißt und es erlaubt kleine Code-Teile zu kompilieren
und den Output verschiedener GCC-Versionen und Architekturen anzusehen (zumindest x86, ARM, MIPS):
\url{http://gcc.beta.godbolt.org/}---Ich hätte es für dieses Buch selber genutzt wenn ich davon gewusst hätte!

\subsection{Rechner}

Gute Rechner für Reverse Engineering sollten zumindest Unterstützung für Dezimal, Hexadezimal und binär-Basen,
sowie wichtige Operationen wie XOR oder Schiebeoperationen haben.

\begin{itemize}

\item IDA hat einen eingebauten Rechner (``?'').

\item rada.re hat \IT{rax2}.

\item \url{https://github.com/dennis714/progcalc}

\item Als letzte Rettung hat der Standard-Rechner von Windows einen Programmierer-Modus.

\end{itemize}

\section{Fehlt etwas?}

Wenn Sie ein gutes Tool kennen, was hier nicht aufgelistet ist, schreiben Sie mir:\\
\TT{\EMAIL}.
